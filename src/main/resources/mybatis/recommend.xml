<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="dev.mvc.recommend.RecommendDAOInter">

	<!-- 등록한 레코드 갯수 1 리턴 -->
	<insert id="create" parameterType="dev.mvc.recommend.RecommendVO">
	    INSERT INTO recommend(recommendno, memno, genreno, , rdate)
	    VALUES(recommend_seq.nextval,  #{memno}, #{genreno}, #{seq}, sysdate)
	</insert>
	
	<select id="list_all" resultType="dev.mvc.recommend.RecommendVO">
	  SELECT recommendno, memno, genreno, seq, rdate
	  FROM recommend    
	  ORDER BY recommendno ASC  
	</select>

  <!-- 1) 1번 회원 로그인시 관심분야를 가져오는 SQL -->
   <select id="mem_genre">
   SELECT genreno FROM recommend WHERE memno=1
   </select>
	<!-- 관심분야의 카테고리 1번 상품중에 recom(추천수) 컬럼의 내림차순 정렬후 상품 목록 10건을 출력 -->
	<select id="list_recom" resultType="dev.mvc.recommend.RecommendVO" parameterType="dev.mvc.recommend.RecommendVO"  >
	   SELECT contentsno, adminno, cateno, title, content, recom, cnt, replycnt, rdate,
           file1, file1saved, thumb1, size1, map, youtube, r
		FROM (
		           SELECT contentsno, adminno, cateno, title, content, recom, cnt, replycnt, rdate,
		                      file1, file1saved, thumb1, size1, map, youtube, rownum as r
		           FROM (
		                     SELECT contentsno, adminno, cateno, title, content, recom, cnt, replycnt, rdate,
		                                file1, file1saved, thumb1, size1, map, youtube
		                     FROM contents
		                     WHERE cateno=1 AND (title LIKE '%단풍%' OR content LIKE '%단풍%' OR word LIKE '%단풍%')
		                     ORDER BY jumsu DESC
		           )          
		)
		WHERE <![CDATA[ r >= 1 AND r <= 10 ]]>
	</select>
	
	<select id="read" resultType="dev.mvc.recommend.RecommendVO" parameterType="int">
	  SELECT recommendno, memno, genreno, seq, rdate
	  FROM recommend    
	  WHERE memno = #{memno}
	  ORDER BY recommendno ASC  
	</select>
	
	<delete id="delete" parameterType="int">
	    DELETE FROM recommend
	    WHERE recommendno=#{recommendno}
	</delete>


</mapper>
